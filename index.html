<!DOCTYPE html>
<html>

<head>
    <title>You Are Not Alone</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
</head>

<body>
    <h1>You Are Not Alone</h1>

    <div id="auth-section">
        <h2>Sign Up / Login</h2>
        <input type="email" id="email" placeholder="Email">
        <input type="password" id="password" placeholder="Password">
        <button id="signup">Sign Up</button>
        <button id="login">Login</button>
        <button id="logout" style="display:none;">Logout</button>
    </div>

    <div id="content-section" style="display:none;">
        <h2>Articles</h2>
        <div id="articles"></div>

        <h2>Post an Article</h2>
        <input type="text" id="article-title" placeholder="Title">
        <textarea id="article-content" placeholder="Content"></textarea>
        <button id="post-article">Post Article</button>
    </div>

    <script>
        // Your Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAROS1azT1qMQC25nEmLBk1f8KXVxKxzwA",
            authDomain: "you-are-not-alone-afe31.firebaseapp.com",
            projectId: "you-are-not-alone-afe31",
            storageBucket: "you-are-not-alone-afe31.appspot.com",
            messagingSenderId: "680954352133",
            appId: "1:680954352133:web:06278fc164ba6e6d94c26c"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // Sign up
        document.getElementById('signup').addEventListener('click', () => {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            auth.createUserWithEmailAndPassword(email, password)
                .then(userCredential => {
                    alert('User signed up');
                    document.getElementById('auth-section').style.display = 'none';
                    document.getElementById('content-section').style.display = 'block';
                })
                .catch(error => {
                    alert(error.message);
                });
        });

        // Login
        document.getElementById('login').addEventListener('click', () => {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            auth.signInWithEmailAndPassword(email, password)
                .then(userCredential => {
                    alert('User logged in');
                    document.getElementById('auth-section').style.display = 'none';
                    document.getElementById('content-section').style.display = 'block';
                    loadArticles();
                })
                .catch(error => {
                    alert(error.message);
                });
        });

        // Logout
        document.getElementById('logout').addEventListener('click', () => {
            auth.signOut()
                .then(() => {
                    alert('User logged out');
                    document.getElementById('auth-section').style.display = 'block';
                    document.getElementById('content-section').style.display = 'none';
                })
                .catch(error => {
                    alert(error.message);
                });
        });

        // Post an article
        document.getElementById('post-article').addEventListener('click', () => {
            const title = document.getElementById('article-title').value;
            const content = document.getElementById('article-content').value;
            const user = auth.currentUser;
            if (user) {
                db.collection('articles').add({
                    title: title,
                    content: content,
                    userId: user.uid,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                })
                    .then(docRef => {
                        alert('Article posted');
                        loadArticles();
                    })
                    .catch(error => {
                        alert(error.message);
                    });
            } else {
                alert('You need to be logged in to post an article');
            }
        });

        // Load articles
        function loadArticles() {
            db.collection('articles').orderBy('timestamp', 'desc').get()
                .then(querySnapshot => {
                    const articlesDiv = document.getElementById('articles');
                    articlesDiv.innerHTML = '';
                    querySnapshot.forEach(doc => {
                        const article = doc.data();
                        articlesDiv.innerHTML += `<h3>${article.title}</h3><p>${article.content}</p><hr>`;
                    });
                })
                .catch(error => {
                    alert(error.message);
                });
        }
    </script>
</body>

</html>